import{c as V,u as H,o as J,b as K,r as l,d as u,j as e,m as N,h}from"./index-Cwv92vJa.js";import{C as Q}from"./credit-card-C8crAutC.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=V("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),se=()=>{const v=H(),{items:p,getCartTotal:G,clearCart:I}=J(),{user:a,isAuthenticated:T,token:k}=K(),[c,y]=l.useState("shipping"),[w,D]=l.useState([]),[$,S]=l.useState(!0),[P,f]=l.useState(null),[C,F]=l.useState(!1),[r,o]=l.useState({fullName:a!=null&&a.firstName&&(a!=null&&a.lastName)?`${a.firstName} ${a.lastName}`:"",email:(a==null?void 0:a.email)||"",phone:"",address:"",city:"",state:"",zipCode:"",country:"United States"}),[i,x]=l.useState({cardNumber:"",cardName:"",expiryDate:"",cvv:"",saveCard:!1}),[z,M]=l.useState(0),[q,O]=l.useState(0),[B,A]=l.useState(0),[X,W]=l.useState(0),L=l.useCallback(async()=>{S(!0),f(null);try{const s=[];let t=0;for(const m of p){const g=await fetch(`http://localhost:3000/api/laptops/${m.productId}`);if(!g.ok)throw new Error(`Failed to fetch product ${m.productId}`);const j=await g.json(),b=j.price*m.quantity;t+=b,s.push({...j,quantity:m.quantity,totalPrice:b})}D(s),M(t);const d=t>999?0:30;O(d);const n=t*.08;A(n),W(t+d+n)}catch(s){console.error("Error fetching cart products:",s),f("Failed to load cart items. Please try again.")}finally{S(!1)}},[p]);l.useEffect(()=>{document.title="Checkout - TechWave",L(),p.length===0&&(v("/cart"),u.error("Your cart is empty"))},[p.length,v,L]);const Y=s=>{s.preventDefault();const{fullName:t,email:d,phone:n,address:m,city:g,state:j,zipCode:b}=r;if(!t||!d||!n||!m||!g||!j||!b){u.error("Please fill in all required fields");return}y("payment"),window.scrollTo(0,0)},R=s=>{s.preventDefault();const{cardNumber:t,cardName:d,expiryDate:n,cvv:m}=i;if(!t||!d||!n||!m){u.error("Please fill in all required fields");return}if(t.replace(/\s/g,"").length!==16){u.error("Please enter a valid card number");return}y("review"),window.scrollTo(0,0)},U=async()=>{F(!0),f(null);try{if(!T||!a||!k)throw new Error("User not authenticated");const s={userId:a.id,totalAmount:X,status:"pending",shippingInfo:r,items:w.map(n=>({productId:n.id,quantity:n.quantity,price:n.price,name:n.name,image:n.images[0]}))},t=await fetch("http://localhost:3000/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify(s)});if(!t.ok)throw new Error(`Failed to place order: ${t.statusText}`);const d=await t.json();I(),u.success("Order placed successfully!"),v(`/profile?order=${d.id}`)}catch(s){console.error("Error placing order:",s),f(s instanceof Error?s.message:"Failed to place order. Please try again."),u.error("Failed to place order. Please try again.")}finally{F(!1)}},E=()=>{c==="payment"?y("shipping"):c==="review"&&y("payment"),window.scrollTo(0,0)};return $?e.jsx("div",{className:"min-h-screen flex items-center justify-center pt-16 md:pt-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):P?e.jsx("div",{className:"min-h-screen flex items-center justify-center pt-16 md:pt-20",children:e.jsxs("div",{className:"text-center text-red-500",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Error Loading Cart"}),e.jsx("p",{className:"text-gray-600 mb-6",children:P}),e.jsx("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center justify-center px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors",children:"Retry"})]})}):e.jsxs(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"pt-16 md:pt-20",children:[e.jsx("div",{className:"bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Checkout"}),e.jsx("p",{className:"text-gray-600",children:"Complete your purchase"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"max-w-4xl mx-auto mb-8",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-2 ${c==="shipping"?"bg-primary-600 text-white":"bg-primary-100 text-primary-600"}`,children:"1"}),e.jsx("div",{className:"text-sm font-medium",children:"Shipping"})]}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx("div",{className:`flex-1 h-1 ${c==="shipping"?"bg-gray-300":"bg-primary-600"}`})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-2 ${c==="payment"?"bg-primary-600 text-white":c==="review"?"bg-primary-100 text-primary-600":"bg-gray-200 text-gray-500"}`,children:"2"}),e.jsx("div",{className:"text-sm font-medium",children:"Payment"})]}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx("div",{className:`flex-1 h-1 ${c==="review"?"bg-primary-600":"bg-gray-300"}`})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-2 ${c==="review"?"bg-primary-600 text-white":"bg-gray-200 text-gray-500"}`,children:"3"}),e.jsx("div",{className:"text-sm font-medium",children:"Review"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"lg:col-span-2",children:[c==="shipping"&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b",children:e.jsx("h2",{className:"font-medium",children:"Shipping Information"})}),e.jsxs("form",{onSubmit:Y,className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",id:"fullName",value:r.fullName,onChange:s=>o({...r,fullName:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx("input",{type:"email",id:"email",value:r.email,onChange:s=>o({...r,email:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),e.jsx("input",{type:"tel",id:"phone",value:r.phone,onChange:s=>o({...r,phone:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Address *"}),e.jsx("input",{type:"text",id:"address",value:r.address,onChange:s=>o({...r,address:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"City *"}),e.jsx("input",{type:"text",id:"city",value:r.city,onChange:s=>o({...r,city:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-700 mb-1",children:"State / Province *"}),e.jsx("input",{type:"text",id:"state",value:r.state,onChange:s=>o({...r,state:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zipCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"Zip Code *"}),e.jsx("input",{type:"text",id:"zipCode",value:r.zipCode,onChange:s=>o({...r,zipCode:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsxs("select",{id:"country",value:r.country,onChange:s=>o({...r,country:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",children:[e.jsx("option",{children:"United States"}),e.jsx("option",{children:"Canada"}),e.jsx("option",{children:"United Kingdom"}),e.jsx("option",{children:"Australia"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",className:"px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors flex items-center",children:["Continue to Payment",e.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]}),c==="payment"&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b",children:e.jsx("h2",{className:"font-medium",children:"Payment Information"})}),e.jsxs("form",{onSubmit:R,className:"p-6",children:[e.jsxs("div",{className:"space-y-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cardNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Number *"}),e.jsx("input",{type:"text",id:"cardNumber",value:i.cardNumber,onChange:s=>x({...i,cardNumber:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",placeholder:"XXXX XXXX XXXX XXXX",maxLength:19,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cardName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name on Card *"}),e.jsx("input",{type:"text",id:"cardName",value:i.cardName,onChange:s=>x({...i,cardName:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expiryDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date (MM/YY) *"}),e.jsx("input",{type:"text",id:"expiryDate",value:i.expiryDate,onChange:s=>x({...i,expiryDate:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",placeholder:"MM/YY",maxLength:5,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cvv",className:"block text-sm font-medium text-gray-700 mb-1",children:"CVV *"}),e.jsx("input",{type:"text",id:"cvv",value:i.cvv,onChange:s=>x({...i,cvv:s.target.value}),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50",placeholder:"XXX",maxLength:4,required:!0})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"saveCard",checked:i.saveCard,onChange:s=>x({...i,saveCard:s.target.checked}),className:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("label",{htmlFor:"saveCard",className:"ml-2 block text-sm text-gray-900",children:"Save this card for future purchases"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{type:"button",onClick:E,className:"text-gray-600 hover:text-gray-800 font-medium flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Shipping"]}),e.jsxs("button",{type:"submit",className:"px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors flex items-center",children:["Review Order",e.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]}),c==="review"&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b",children:e.jsx("h2",{className:"font-medium",children:"Review Your Order"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"font-medium text-lg mb-4",children:"Items in Cart"}),e.jsx("div",{className:"space-y-4 mb-6",children:w.map(s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-md overflow-hidden flex-shrink-0",children:e.jsx("img",{src:s.images[0],alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Qty: ",s.quantity]}),e.jsx("div",{className:"text-sm font-bold",children:h(s.totalPrice)})]})]},s.id))}),e.jsx("h3",{className:"font-medium text-lg mb-4",children:"Shipping Details"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"font-medium",children:r.fullName}),e.jsx("p",{className:"text-gray-600",children:r.address}),e.jsxs("p",{className:"text-gray-600",children:[r.city,", ",r.state," ",r.zipCode]}),e.jsx("p",{className:"text-gray-600",children:r.country}),e.jsx("p",{className:"text-gray-600 mt-2",children:r.phone})]}),e.jsx("h3",{className:"font-medium text-lg mb-4",children:"Payment Method"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"w-6 h-6 mr-3 text-gray-500"}),e.jsxs("p",{className:"font-medium",children:["Card ending in ",i.cardNumber.slice(-4)]})]}),e.jsxs("p",{className:"text-gray-600",children:["Expires ",i.expiryDate]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{type:"button",onClick:E,className:"text-gray-600 hover:text-gray-800 font-medium flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Payment"]}),e.jsxs("button",{onClick:U,disabled:C,className:"px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[C?"Processing...":"Place Order",C?e.jsxs("svg",{className:"animate-spin h-5 w-5 ml-2 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(Z,{className:"w-4 h-4 ml-2"})]})]})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b",children:e.jsx("h2",{className:"font-medium",children:"Order Summary"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-gray-600",children:["Subtotal (",w.length," items)"]}),e.jsx("span",{className:"font-medium",children:h(z)})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsx("span",{className:"font-medium",children:q===0?"Free":h(q)})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-4",children:[e.jsx("span",{className:"text-gray-600",children:"Estimated Tax (8%)"}),e.jsx("span",{className:"font-medium",children:h(B)})]}),e.jsxs("div",{className:"flex justify-between items-center font-bold text-lg",children:[e.jsx("span",{children:"Order Total"}),e.jsx("span",{children:h(X)})]})]})]})})]})]})]})};export{se as default};
